# C++ 环境配置

## 📋 前言

本教程将手把手教你在 Windows 系统上配置 C++ 开发环境。我们提供两套方案，你可以根据自己的需求选择其一：
- **方案一（VS + MSVC）**：更适合纯 Windows 开发，IDE 功能强大，适合新手
- **方案二（VS Code + WSL + g++）**：更轻量级，跨平台能力强

---

## 🟢 方案一：Visual Studio + MSVC

### 📌 优点
- 集成开发环境（IDE）功能完整，调试功能强大
- 安装配置简单，开箱即用
- 官方支持，适合 Windows 平台开发

### 📌 缺点
- 软件体积较大（安装后约 10-20 GB）
- 启动速度相对较慢

---

### 🔧 详细安装步骤

#### **步骤 1：下载 Visual Studio**

1. 打开浏览器，访问 [Visual Studio 官网](https://visualstudio.microsoft.com/zh-hans/vs/)
2. 在页面中找到 **"下载 Visual Studio"** 区域
3. 选择 **"Community 2022"** 版本（完全免费，功能完整）
   - Community：免费版，个人和小团队使用
   - Professional/Enterprise：付费版，企业使用
4. 点击下载，文件名类似 `VisualStudioSetup.exe`，大小约 3-5 MB（这只是启动器）

---

#### **步骤 2：运行安装程序**

1. 双击下载的 `VisualStudioSetup.exe` 文件
2. 如果弹出用户账户控制（UAC）提示，点击 **"是"**
3. 安装程序会先下载并准备 Visual Studio Installer（约等待 1-2 分钟）

---

#### **步骤 3：选择工作负载（重要！）**

1. Visual Studio Installer 启动后，会显示 **"工作负载"** 选择界面
2. 在 **"桌面和移动应用"** 分类下，找到并勾选：
   ```
使用 C++ 的桌面开发
   ```
3. **【重要】** 右侧会显示该工作负载包含的组件，建议保持默认选择，主要包括：
   - MSVC v143 - VS 2022 C++ x64/x86 生成工具
   - Windows SDK
   - C++ CMake 工具
   - 用于 Windows 的 C++ Clang 工具
   - C++ 分析工具

4. **修改安装位置（可选但推荐）**：
   - 点击右下角的 **"安装位置"** 标签
   - 修改安装路径（建议安装到 D 盘或其他非系统盘，避免 C 盘空间不足）
   - 例如：`D:\Program Files\Microsoft Visual Studio\2022\Community`

5. 确认磁盘空间充足（至少需要 10-20 GB 可用空间）

---

#### **步骤 4：开始安装**

1. 点击右下角的 **"安装"** 按钮
2. 安装过程需要 30 分钟到 2 小时（取决于网速和电脑配置）
3. 安装完成后，点击 **"启动"** 按钮

---

#### **步骤 5：首次启动配置**

1. 首次启动时，会要求登录 Microsoft 账户（可以跳过，点击 "以后再说"）
2. 选择开发设置：
   - 开发设置：选择 **"Visual C++"**
   - 颜色主题：根据个人喜好选择（推荐 "深色"）
3. 点击 **"启动 Visual Studio"**

---

#### **步骤 6：创建第一个 C++ 项目（验证安装）**

1. 在 Visual Studio 启动界面，选择 **"创建新项目"**
2. 在搜索框中输入 **"控制台"**
3. 选择 **"控制台应用"**（确保语言标签显示 **C++**）
4. 点击 **"下一步"**
5. 配置项目：
   - 项目名称：输入 `HelloWorld`
   - 位置：选择项目保存位置（建议在 D 盘创建专门的项目文件夹）
   - 勾选 **"将解决方案和项目放在同一目录中"**（可选）
6. 点击 **"创建"**

---

#### **步骤 7：编写并运行测试代码**

1. Visual Studio 会自动生成一个包含示例代码的文件
2. 将代码替换为以下内容：

```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello, C++!" << endl;
    cout << "环境配置成功！" << endl;
    
    // 防止程序立即退出
    system("pause");
    return 0;
}
```

3. **编译并运行**：
   - 按快捷键 **Ctrl + F5**（不调试运行）
   - 或点击顶部菜单栏：**调试 → 开始执行（不调试）**
   - 或直接点击顶部工具栏的绿色三角形按钮（确保旁边显示 "本地 Windows 调试器"）

4. **验证结果**：
   - 应该弹出一个黑色控制台窗口
   - 显示：
     ```
     Hello, C++!
     环境配置成功！
     请按任意键继续. . .
     ```
   - 如果看到以上输出，说明环境配置成功！

---

#### **步骤 8：常用快捷键（可选）**

- **Ctrl + F5**：运行程序（不调试）
- **F5**：调试运行程序
- **F9**：设置/取消断点
- **Ctrl + K, Ctrl + D**：格式化代码
- **Ctrl + Shift + B**：生成解决方案

---

### ❗ 常见问题及解决方案

#### 问题 1：安装时提示"磁盘空间不足"
**解决方案**：
- 清理 C 盘空间或修改安装路径到其他盘
- 使用磁盘清理工具清理临时文件
- 卸载不必要的软件

#### 问题 2：运行程序时提示"无法启动程序"
**解决方案**：
- 确保项目已成功生成（查看输出窗口是否有错误）
- 检查项目配置平台是否与系统匹配（x64 或 x86）
- 关闭杀毒软件再试

#### 问题 3：中文输出乱码
**解决方案**：
- 在代码开头添加：
```cpp
#include <Windows.h>
SetConsoleOutputCP(65001); // 设置控制台输出为 UTF-8
```

---

## 🔵 方案二：VS Code + WSL + g++

### 📌 优点
- 轻量级，启动速度快
- 跨平台，使用 Linux 工具链
- 更接近企业级开发环境
- 插件生态丰富

### 📌 缺点
- 配置相对复杂
- 需要熟悉命令行操作
- 需要额外安装编译器

---

### 🔧 详细安装步骤

#### **第一部分：安装 VS Code**

##### **步骤 1：下载 VS Code**

1. 打开浏览器，访问 [Visual Studio Code 官网](https://code.visualstudio.com/)
2. 网站会自动识别你的系统，点击 **"Download for Windows"** 按钮
3. 下载文件名类似 `VSCodeUserSetup-x64-1.x.x.exe`

##### **步骤 2：安装 VS Code**

1. 双击下载的安装程序
2. 选择同意许可协议，点击 **"下一步"**
3. **【推荐勾选以下选项】**：
   ```
   ✅ 添加到 PATH（重要！）
   ✅ 添加"通过 Code 打开"操作到 Windows 资源管理器文件上下文菜单
   ✅ 添加"通过 Code 打开"操作到 Windows 资源管理器目录上下文菜单
   ✅ 将 Code 注册为受支持的文件类型的编辑器
   ```
4. 点击 **"安装"**
5. 安装完成后，勾选 **"启动 Visual Studio Code"**，点击 **"完成"**

##### **步骤 3：安装必要的扩展插件**

1. **安装中文语言包**：
   - 点击左侧活动栏的 **Extensions（扩展）** 图标（或按 **Ctrl + Shift + X**）
   - 在搜索框输入：`Chinese`
   - 找到 **"Chinese (Simplified) (简体中文) Language Pack for Visual Studio Code"**
   - 点击 **"Install"** 安装
   - 安装后右下角会提示重启，点击 **"Restart"** 重启 VS Code

2. **安装 C/C++ 扩展**：
   - 在扩展搜索框输入：`C++`
   - 找到 **"C/C++"**（发布者：Microsoft）
   - 点击 **"安装"**

3. **安装 WSL 扩展**：
   - 在扩展搜索框输入：`WSL`
   - 找到 **"WSL"**（发布者：Microsoft）
   - 点击 **"安装"**

4. **安装 Code Runner（可选，方便运行代码）**：
   - 在扩展搜索框输入：`Code Runner`
   - 找到 **"Code Runner"**（发布者：Jun Han）
   - 点击 **"安装"**

---

#### **第二部分：安装和配置 WSL**

##### **步骤 1：启用 WSL 功能**

1. **以管理员身份打开 PowerShell**：
   - 按 **Win + X** 键
   - 选择 **"Windows PowerShell (管理员)"** 或 **"终端 (管理员)"**
   - 如果弹出 UAC 提示，点击 **"是"**

2. **安装 WSL**：
   - 在 PowerShell 中输入以下命令：
   ```powershell
   wsl --install
   ```
   - 按 **Enter** 执行

3. **等待安装完成**：
   - 系统会自动下载并安装 WSL 2 和 Ubuntu（默认发行版）
   - 这个过程需要 10-30 分钟（取决于网速）
   - 安装过程中会显示进度信息

4. **重启计算机**：
   - 安装完成后，系统会提示重启
   - 保存所有工作，然后重启电脑

##### **步骤 2：初始化 Ubuntu**

1. **启动 Ubuntu**：
   - 重启后，在开始菜单搜索 **"Ubuntu"**
   - 点击打开（第一次启动需要几分钟初始化）

2. **创建 Linux 用户账户**：
   - 系统会提示：`Installing, this may take a few minutes...`
   - 等待 1-3 分钟后，会提示：`Enter new UNIX username:`
   - 输入用户名（建议使用小写字母，如 `yourname`），按 **Enter**
   - 提示：`New password:`
   - 输入密码（**注意：输入时不会显示任何字符，这是正常的**）
   - 提示：`Retype new password:`
   - 再次输入相同的密码
   - 设置成功后会显示：`Installation successful!`

3. **验证安装**：
   - 你现在应该看到类似这样的命令提示符：
   ```
   yourname@DESKTOP-XXXXX:~$
   ```
   - 这表示你已经成功进入 Linux 环境

##### **步骤 3：安装 C++ 编译器和调试器**

1. **更新软件包列表**：
   ```bash
   sudo apt-get update
   ```
   - 输入你刚才设置的密码（输入时不显示）
   - 按 **Enter**，等待更新完成（约 1-2 分钟）

2. **安装编译工具**：
   ```bash
   sudo apt-get install build-essential gdb -y
   ```
   - 该命令会安装：
     - `g++`：C++ 编译器
     - `gcc`：C 编译器
     - `make`：构建工具
     - `gdb`：调试器
   - 等待安装完成（约 3-5 分钟）

3. **验证安装**：
   ```bash
   g++ --version
   ```
   - 应该显示类似：
   ```
   g++ (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0
   Copyright (C) 2021 Free Software Foundation, Inc.
   ```

   ```bash
   gdb --version
   ```
   - 应该显示 GDB 的版本信息

   ```bash
   whereis g++
   whereis gdb
   ```
   - 应该显示 g++ 和 gdb 的安装路径

---

#### **第三部分：配置 VS Code 连接 WSL**

##### **步骤 1：在 WSL 中打开 VS Code**

1. 在 Ubuntu 终端中，输入：
   ```bash
   cd ~
   mkdir cpp_projects
   cd cpp_projects
   code .
   ```

2. 第一次运行会自动安装 **"VS Code Server"**，等待安装完成

3. VS Code 会自动打开，左下角应该显示 **"WSL: Ubuntu"**（绿色标识）

##### **步骤 2：创建测试项目**

1. 在 VS Code 中，点击 **"新建文件"** 或按 **Ctrl + N**
2. 保存文件为 `test.cpp`（**Ctrl + S**）
3. 输入以下测试代码：

```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello from WSL!" << endl;
    cout << "C++ 环境配置成功！" << endl;
    
    // 测试输入
    int num;
    cout << "请输入一个数字: ";
    cin >> num;
    cout << "你输入的是: " << num << endl;
    
    return 0;
}
```

##### **步骤 3：配置编译和调试（重要！）**

1. **创建 .vscode 配置文件夹**：
   - 在 VS Code 中按 **Ctrl + Shift + P** 打开命令面板
   - 输入：`C/C++: Edit Configurations (JSON)`
   - 选择后会自动创建 `.vscode/c_cpp_properties.json` 文件

2. **配置编译任务**：
   - 按 **Ctrl + Shift + P**
   - 输入：`Tasks: Configure Default Build Task`
   - 选择：**"C/C++: g++ 生成活动文件"**
   - 会自动创建 `.vscode/tasks.json` 文件

3. **配置调试**：
   - 按 **Ctrl + Shift + P**
   - 输入：`Debug: Add Configuration`
   - 选择：**"C++ (GDB/LLDB)"**
   - 再选择：**"g++ - 生成和调试活动文件"**
   - 会自动创建 `.vscode/launch.json` 文件

##### **步骤 4：编译和运行程序**

**方法一：使用终端编译（推荐学习）**
1. 在 VS Code 中按 **Ctrl + `**（反引号）打开集成终端
2. 确保终端显示为 **"bash"**（WSL 环境）
3. 输入编译命令：
   ```bash
   g++ test.cpp -o test
   ```
4. 运行程序：
   ```bash
   ./test
   ```

**方法二：使用 VS Code 快捷键**
1. 按 **Ctrl + Shift + B**（编译）
2. 按 **F5**（调试运行）或 **Ctrl + F5**（直接运行）

**方法三：使用 Code Runner（最简单）**
1. 右键点击代码编辑器
2. 选择 **"Run Code"**
3. 或者直接按 **Ctrl + Alt + N**

##### **步骤 5：验证输出**

运行成功后，应该在终端看到：
```
Hello from WSL!
C++ 环境配置成功！
请输入一个数字: 
```
输入一个数字后，会显示你输入的内容。

---

### ❗ 常见问题及解决方案

#### 问题 1：WSL 安装失败或无法启动
**解决方案**：
1. 确保 Windows 版本为 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11
2. 检查是否启用了虚拟化：
   - 打开任务管理器（Ctrl + Shift + Esc）
   - 点击 "性能" 标签
   - 查看 "虚拟化" 是否为 "已启用"
3. 如果虚拟化未启用，需要在 BIOS 中启用（不同主板操作不同，请搜索具体型号）

#### 问题 2：VS Code 无法连接到 WSL
**解决方案**：
1. 确保 WSL 扩展已正确安装
2. 在 PowerShell 中运行 `wsl --list --verbose` 检查 WSL 状态
3. 尝试重启 WSL：`wsl --shutdown`，然后重新打开 Ubuntu

#### 问题 3：编译时提示 "g++: command not found"
**解决方案**：
1. 确保你在 WSL 环境中（VS Code 左下角显示 "WSL: Ubuntu"）
2. 重新运行安装命令：`sudo apt-get install build-essential gdb -y`
3. 检查安装：`which g++`

#### 问题 4：中文输出乱码
**解决方案**：
1. 在终端中设置语言环境：
```bash
sudo apt-get install language-pack-zh-hans
export LANG=zh_CN.UTF-8
```
2. 或者在代码中使用 `setlocale(LC_ALL, "zh_CN.UTF-8");`

---

# ▶️ 接下来该做什么？

- 如果你想**打比赛、刷题、练算法** → 前往 [竞赛之径](./竞赛之径/README.md)
- 如果你想**做项目、写工具、建作品集** → 前往 [工程之基](./工程之基/README.md)
